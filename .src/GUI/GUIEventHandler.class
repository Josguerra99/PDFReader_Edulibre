' Gambas class file

Public Sub AddEvents()
  Object.Attach(FMain.btnNext, Me, "Next")
  Object.Attach(FMain.btnPrevious, Me, "Previous")
  Object.Attach(FMain.txtPage, Me, "PageTxt")
  Object.Attach(FMain.btnOpen, Me, "Open")
  Object.Attach(FMain.ZoomSlider, Me, "ZoomSlider")
  Object.Attach(FMain.ZoomTxt, Me, "ZoomTxt")
  Object.Attach(FMain.btnRotateLeft, Me, "RotateLeft")
  Object.Attach(FMain.btnRotateRight, Me, "RotateRight")
  Object.Attach(FMain, Me, "Form")
End

Public Sub Open_Click() 
  FMain.OpenDialogPath()  
End
Public Sub Next_Click() 
  Main.GoToPage(Main.pdf.CurrentPage + 1)
End
Public Sub Previous_Click() 
  Main.GoToPage(Main.pdf.CurrentPage - 1)
End

Public Sub PageTxt_KeyPress()
  If Key.Code == Key.Enter Or Key.Code == Key.Return Then
    Main.GoToPage(CInt(FMain.txtPage.Text))
  Endif    
  Catch
    Print "No se puede ir a la pagina " & FMain.txtPage.Text
    If Not IsNull(Main.pdf) Then
     FMain.txtPage.Text = pdf.CurrentPage
    Endif
End



Public Sub ZoomSlider_Change()  
   Main.UpdateZoomRender(FMain.zoomSlider.Value / 100)
End

Public Sub ZoomTxt_KeyPress()
  If Key.Code == Key.Enter Or Key.Code == Key.Return Then
    Main.UpdateZoomRender(CInt(FMain.zoomTxt.Text) / 100) 
  Endif    
  Catch
    Print "No se puede hacer un zoom con valor: " & FMain.zoomTxt.Text
    Main.SetZoom(Main.currentZoom)
End

Public Sub RotateLeft_Click() 
  Main.Rotate(-1)  
End
Public Sub RotateRight_Click() 
  Main.Rotate(1)  
End

Public Sub Form_Close()
  Main.Exit()
End
Public Sub Form_Resize()
  FMain.UpdateLayout()
End







